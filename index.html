<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UFC Picks</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 700px; margin: auto; }
    h1 { text-align: center; }
    .fight { margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
    select { padding: 5px; margin-top: 5px; width: 100%; }
    button { padding: 10px 20px; margin-top: 20px; font-size: 16px; }
    label { display: block; font-weight: bold; margin-top: 15px; }
    input[type="text"] { padding: 8px; width: 100%; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>UFC Picks</h1>

  <label for="username">Enter Your Name</label>
  <input type="text" id="username" placeholder="Your name or nickname" />

  <div id="fights"></div>

  <button onclick="submitPicks()">Submit Picks</button>

  <script>
    const sheetAPI = 'https://script.google.com/macros/s/AKfycbza6acSx7uA8Rdm_pNY_kCl4v2_okkcRyCxae38Y59BRfKw6dWzaMUZiKNrbqIWp7baWg/exec'; // replace with your deployed Apps Script URL

    async function loadFights() {
      const res = await fetch(sheetAPI + '?action=getFights');
      const data = await res.json();
      const container = document.getElementById('fights');

      data.forEach((fight, index) => {
        const div = document.createElement('div');
        div.className = 'fight';
        div.innerHTML = `
          <label for="fight${index}">${fight.fighterA} vs ${fight.fighterB}</label>
          <select id="fight${index}">
            <option value="">-- Choose winner --</option>
            <option value="${fight.fighterA}">${fight.fighterA}</option>
            <option value="${fight.fighterB}">${fight.fighterB}</option>
          </select>
        `;
        container.appendChild(div);
      });
    }

    async function submitPicks() {
      const username = document.getElementById('username').value.trim();
      if (!username) return alert('Please enter your name.');

      const selects = document.querySelectorAll('select');
      const picks = Array.from(selects).map(s => s.value);

      if (picks.some(p => !p)) return alert('Please make all picks.');

      const res = await fetch(sheetAPI, {
        method: 'POST',
        body: JSON.stringify({ action: 'submitPicks', user: username, picks }),
        headers: { 'Content-Type': 'application/json' }
      });

      const result = await res.text();
      alert(result);
    }

    loadFights();
  </script>
</body>
</html>
